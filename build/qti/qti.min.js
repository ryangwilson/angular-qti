/*
* qti-1.2-engine 0.1.0
*/
!function(a,b){b["qti-1.2-engine"]=a,angular.module("qti.plugins",[]),angular.module("qti",["qti.plugins","ngSanitize"]),angular.module("qti").constant("ATTR_MAP",{fontsize:"font-size",fontface:"font-family",backgroundColor:"background-color",width:"width",height:"height"}),angular.module("qti").service("helpers",function(){this.strToXML=function(a){var b,c;return window.DOMParser?(b=new DOMParser,c=b.parseFromString(a,"text/xml")):(c=new ActiveXObject("Microsoft.XMLDOM"),c.async=!1,c.loadXML(a)),c},this.addClass=function(a,b){a.classList?a.classList.add(b):a.className+=" "+b},this.removeClass=function(a,b){a.classList?a.classList.remove(b):a.className=a.className.replace(new RegExp("(^|\\b)"+b.split(" ").join("|")+"(\\b|$)","gi")," ")}}),angular.module("qti").directive("qti",["$http","$compile","helpers",function(a,b){function c(a){return a.split("<![CDATA[").join("").split("]]>").join("")}function d(a){return a}return{restrict:"E",scope:!0,link:function(e,f,g){e.src=null,e.template=null,e.content=null,a.get(g.src).then(function(a){e.src=a.data,e.template=c(e.src),e.template=d(e.template),e.$emit("qti::setup");var g=b(e.template);e.content=g(e),f.append(e.content),e.$emit("qti::ready")})}}}]),angular.module("qti").directive("font",function(){return{restrict:"E",scope:!0,link:function(a,b,c){c.size;b[0].removeAttribute("size"),b.css("fontSize",c.size+"px")}}}),angular.module("qti").directive("img",function(){return{restrict:"E",scope:!0,link:function(a,b,c){c.hasOwnProperty("align")&&b.css("vertical-align",c.align)}}}),angular.module("qti.plugins").service("scripting",["$rootScope",function(a){var b=function(a){return a.replace(/<dyn type="text\/groovy">(\s?)+return(\s?)+((.|\n)*?)(;?)<\/dyn>/gim,"{{ $3 }}")},c=function(a){return a.replace(/\${(\s?)+((.|\n)*?)\}/gim,"{{ system.$2 }}")};a.$on("qti::setup",function(a){a.targetScope.template=b(a.targetScope.template),a.targetScope.template=c(a.targetScope.template)})}]).run(["scripting",function(){}]),angular.module("qti.plugins").directive("tabStops",["$compile",function(a){function b(a){var b={};if(a)for(var c,d,e,f=a.split(";"),g=0;g<f.length;g+=1)c=f[g].split(":"),d=(c[0]+"").trim(),e=(c[1]+"").trim(),"interval"===d?b[d]=Number(e):"tabset"===d?b[d]=JSON.parse('{"list": ['+e+"]}").list:"alignment"===d&&(b[d]=e.match(/\w+/gim),1===b[d].length&&(b[d]=b[d][0]));return b}return{restrict:"A",link:function(c,d,e){var f,g,h=b(e.tabStops),i=d.html(),j=i.split("	").length-1;if(j)if(h.hasOwnProperty("interval"))i=i.split("	").join('<span style="padding-right:'+h.interval+'in"></span>'),i="<div>"+i+"</div>",f=a(i),g=f(c),d.empty(),d.append(g);else if(h.hasOwnProperty("tabset")){var k="";i=i.split("	");for(var l=0;l<i.length;l+=1)k+=i[l]+'<span style="padding-right:'+h.tabset[l]+'in"></span>';i="<div>"+k+"</div>",f=a(i),g=f(c),d.empty(),d.append(g)}}}}]),angular.module("qti.plugins").constant("VG_STATES",{PLAY:"play",PAUSE:"pause",STOP:"stop"}).service("VG_UTILS",function(){this.fixEventOffset=function(a){if(navigator.userAgent.match(/Firefox/i)){var b=a.currentTarget.currentStyle||window.getComputedStyle(a.target,null),c=parseInt(b.borderLeftWidth,10),d=parseInt(b.borderTopWidth,10),e=a.currentTarget.getBoundingClientRect(),f=a.clientX-c-e.left,g=a.clientY-d-e.top;a.offsetX=f,a.offsetY=g}return a},this.getZIndex=function(){var a=1;return angular.element("*").filter(function(){return"auto"!==angular.element(this).css("zIndex")}).each(function(){var b=parseInt(angular.element(this).css("zIndex"));b>a&&(a=b+1)}),a},this.secondsToDate=function(a){var b=new Date;return b.setTime(1e3*a),b},this.isMobileDevice=function(){return"undefined"!=typeof window.orientation||-1!==navigator.userAgent.indexOf("IEMobile")},this.isiOSDevice=function(){return navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/iPad/i)}}).run(["$window","VG_UTILS",function(a,b){var c,d={w3:{enabled:"fullscreenEnabled",element:"fullscreenElement",request:"requestFullscreen",exit:"exitFullscreen",onchange:"fullscreenchange",onerror:"fullscreenerror"},newWebkit:{enabled:"webkitFullscreenEnabled",element:"webkitFullscreenElement",request:"webkitRequestFullscreen",exit:"webkitExitFullscreen",onchange:"webkitfullscreenchange",onerror:"webkitfullscreenerror"},oldWebkit:{enabled:"webkitIsFullScreen",element:"webkitCurrentFullScreenElement",request:"webkitRequestFullScreen",exit:"webkitCancelFullScreen",onchange:"webkitfullscreenchange",onerror:"webkitfullscreenerror"},moz:{enabled:"mozFullScreen",element:"mozFullScreenElement",request:"mozRequestFullScreen",exit:"mozCancelFullScreen",onchange:"mozfullscreenchange",onerror:"mozfullscreenerror"},ios:{enabled:"webkitFullscreenEnabled",element:"webkitFullscreenElement",request:"webkitEnterFullscreen",exit:"webkitExitFullscreen",onchange:"webkitfullscreenchange",onerror:"webkitfullscreenerror"},ms:{enabled:"msFullscreenEnabled",element:"msFullscreenElement",request:"msRequestFullscreen",exit:"msExitFullscreen",onchange:"msfullscreenchange",onerror:"msfullscreenerror"}};for(var e in d)if(d[e].enabled in document){c=d[e],c.isFullScreen=function(){return null!=document[this.element]};break}b.isiOSDevice()&&(c=d.ios,c.isFullScreen=function(){return null!=document[this.element]}),angular.element(a)[0].fullScreenAPI=c}]).directive("videogular",["$window","VG_STATES","VG_UTILS",function(a,b,c){return{restrict:"E",scope:{theme:"=vgTheme",autoPlay:"=vgAutoplay",vgComplete:"&",vgUpdateVolume:"&",vgUpdateTime:"&",vgUpdateState:"&",vgPlayerReady:"&",vgChangeSource:"&"},controller:["$scope","$timeout",function(d,e){var f=null,g=!1,h=!1,i=d.vgComplete(),j=d.vgUpdateVolume(),k=d.vgUpdateTime(),l=d.vgUpdateState(),m=d.vgPlayerReady(),n=d.vgChangeSource();this.videogularElement=null,this.clearMedia=function(){d.API.mediaElement[0].src=""},this.onMobileVideoReady=function(a,b){this.onVideoReady(a,b,!0)},this.onVideoReady=function(a,f,g){d.API.isReady=!0,d.API.currentState=b.STOP,g||d.$apply(),h=!0,d.vgPlayerReady()&&(m=d.vgPlayerReady())(d.API),(d.autoPlay&&!c.isMobileDevice()||d.API.currentState===b.PLAY)&&e(function(){d.API.play()})},this.onUpdateTime=function(a){d.API.currentTime=c.secondsToDate(a.target.currentTime),d.API.totalTime=c.secondsToDate(a.target.duration),d.API.timeLeft=c.secondsToDate(a.target.duration-a.target.currentTime),d.vgUpdateTime()&&(k=d.vgUpdateTime())(a.target.currentTime,a.target.duration),d.$apply()},this.$on=function(){d.$on.apply(d,arguments)},this.seekTime=function(a,b){var e;b?(e=a*d.API.mediaElement[0].duration/100,d.API.mediaElement[0].currentTime=e):(e=a,d.API.mediaElement[0].currentTime=e),d.API.currentTime=c.secondsToDate(e)},this.playPause=function(){d.API.mediaElement[0].paused?this.play():this.pause()},this.setState=function(a){return a&&a!=d.API.currentState&&(d.vgUpdateState()&&(l=d.vgUpdateState())(a),d.API.currentState=a),d.API.currentState},this.play=function(){d.API.mediaElement[0].play(),this.setState(b.PLAY)},this.pause=function(){d.API.mediaElement[0].pause(),this.setState(b.PAUSE)},this.stop=function(){d.API.mediaElement[0].pause(),d.API.mediaElement[0].currentTime=0,this.setState(b.STOP)},this.toggleFullScreen=function(){angular.element(a)[0].fullScreenAPI?angular.element(a)[0].fullScreenAPI.isFullScreen()?c.isMobileDevice()||document[angular.element(a)[0].fullScreenAPI.exit]():c.isMobileDevice()?c.isiOSDevice()?h?this.enterElementInFullScreen(d.API.mediaElement[0]):(g=!0,this.play()):this.enterElementInFullScreen(d.API.mediaElement[0]):this.enterElementInFullScreen(d.API.videogularElement[0]):(d.API.isFullScreen?(d.API.videogularElement.removeClass("fullscreen"),d.API.videogularElement.css("z-index",0)):(d.API.videogularElement.addClass("fullscreen"),d.API.videogularElement.css("z-index",c.getZIndex())),d.API.isFullScreen=!d.API.isFullScreen)},this.enterElementInFullScreen=function(b){b[angular.element(a)[0].fullScreenAPI.request]()},this.changeSource=function(a){d.vgChangeSource()&&(n=d.vgChangeSource())(a)},this.setVolume=function(a){d.vgUpdateVolume()&&(j=d.vgUpdateVolume())(a),d.API.mediaElement[0].volume=a,d.API.volume=a},this.updateTheme=function(a){if(f)for(var b=document.getElementsByTagName("link"),c=0,d=b.length;d>c;c++)b[c].outerHTML.indexOf(f)>=0&&b[c].parentNode.removeChild(b[c]);if(a){var e=angular.element(document).find("head");e.append("<link rel='stylesheet' href='"+a+"'>"),f=a}},this.onStartBuffering=function(){d.API.isBuffering=!0},this.onStartPlaying=function(a){a.target.width++,a.target.width--,d.API.isBuffering=!1},this.onComplete=function(){d.vgComplete()&&(i=d.vgComplete())(),d.API.setState(b.STOP),d.API.isCompleted=!0,d.$apply()},d.API=this,d.init=function(){d.API.isReady=!1,d.API.isCompleted=!1,d.API.currentTime=0,d.API.totalTime=0,d.API.timeLeft=0,d.API.updateTheme(d.theme),d.addBindings(),angular.element(a)[0].fullScreenAPI&&document.addEventListener(angular.element(a)[0].fullScreenAPI.onchange,d.onFullScreenChange)},d.addBindings=function(){d.$watch("theme",function(a,b){a!=b&&d.API.updateTheme(a)}),d.$watch("autoPlay",function(a,b){a!=b&&a&&d.API.play()})},d.onFullScreenChange=function(){d.API.isFullScreen=angular.element(a)[0].fullScreenAPI.isFullScreen(),d.$apply()},d.$on("$destroy",this.clearMedia),d.$on("$routeChangeStart",this.clearMedia),d.init()}],link:{pre:function(a,b,c,d){d.videogularElement=angular.element(b)}}}}]).directive("vgVideo",["$compile","VG_UTILS",function(a,b){return{restrict:"E",require:"^videogular",scope:{vgSrc:"=",vgLoop:"=",vgPreload:"=",vgNativeControls:"=",vgTracks:"="},link:function(c,d,e,f){var g='<video vg-source="vgSrc" ';g+="></video>",f.mediaElement=angular.element(g);var h=a(f.mediaElement)(c);f.mediaElement[0].addEventListener("loadedmetadata",f.onVideoReady,!1),f.mediaElement[0].addEventListener("waiting",f.onStartBuffering,!1),f.mediaElement[0].addEventListener("ended",f.onComplete,!1),f.mediaElement[0].addEventListener("playing",f.onStartPlaying,!1),f.mediaElement[0].addEventListener("timeupdate",f.onUpdateTime,!1),d.append(h),b.isMobileDevice()&&(f.mediaElement[0].removeEventListener("loadedmetadata",f.onVideoReady,!1),f.onMobileVideoReady())}}}]).directive("vgAudio",["$compile","VG_UTILS",function(a,b){return{restrict:"E",require:"^videogular",scope:{vgSrc:"=",vgLoop:"=",vgPreload:"=",vgNativeControls:"=",vgTracks:"="},link:function(c,d,e,f){var g='<audio vg-source="vgSrc" ';g+="></audio>",f.mediaElement=angular.element(g);var h=a(f.mediaElement)(c);f.mediaElement[0].addEventListener("loadedmetadata",f.onVideoReady,!1),f.mediaElement[0].addEventListener("waiting",f.onStartBuffering,!1),f.mediaElement[0].addEventListener("ended",f.onComplete,!1),f.mediaElement[0].addEventListener("playing",f.onStartPlaying,!1),f.mediaElement[0].addEventListener("timeupdate",f.onUpdateTime,!1),d.append(h),b.isMobileDevice()&&(f.mediaElement[0].removeEventListener("loadedmetadata",f.onVideoReady,!1),f.onMobileVideoReady())}}}]).directive("vgSource",[function(){return{restrict:"A",link:{pre:function(a,b,c){function d(){if(f="",b[0].canPlayType){for(var a=0,c=e.length;c>a;a++)if(f=b[0].canPlayType(e[a].type),"maybe"==f||"probably"==f){b.attr("src",e[a].src),b.attr("type",e[a].type);break}}else b.attr("src",e[0].src),b.attr("type",e[0].type)}var e,f;a.$watch(c.vgSource,function(a,b){e&&a==b||!a||(e=a,d())})}}}}]).directive("vgTracks",[function(){return{restrict:"A",require:"^videogular",link:{pre:function(a,b,c,d){function e(){var a=d.mediaElement.children();for(h=0,i=a.length;i>h;h++)a[h].remove();if(f)for(h=0,i=f.length;i>h;h++){g="",g+="<track ";for(var b in f[h])g+=b+'="'+f[h][b]+'" ';g+="></track>",d.mediaElement.append(g,f[h].src)}}var f,g,h,i;a.$watch(c.vgTracks,function(a,b){f&&a==b||(f=a,d.tracks=f,e())})}}}}]).directive("vgLoop",[function(){return{restrict:"A",require:"^videogular",link:{pre:function(a,b,c,d){var e;a.$watch(c.vgLoop,function(a,b){e&&a==b||!a?d.mediaElement.removeAttr("loop"):(e=a,d.mediaElement.attr("loop",e))})}}}}]).directive("vgPreload",[function(){return{restrict:"A",require:"^videogular",link:{pre:function(a,b,c,d){var e;a.$watch(c.vgPreload,function(a,b){e&&a==b||!a?d.mediaElement.removeAttr("preload"):(e=a,d.mediaElement.attr("preload",e))})}}}}]).directive("vgNativeControls",[function(){return{restrict:"A",require:"^videogular",link:{pre:function(a,b,c,d){var e;a.$watch(c.vgNativeControls,function(a,b){e&&a==b||!a?d.mediaElement.removeAttr("controls"):(e=a,d.mediaElement.attr("controls",""))})}}}}]),angular.module("qti").directive("assessment",function(){return{restrict:"E",scope:!0,transclude:!0,templateUrl:"templates/assessment.html",link:function(a,b,c){a.assessment={id:c.ident,title:c.title}}}}),angular.module("qti").directive("flowMat",["ATTR_MAP",function(a){return{restrict:"E",scope:!0,link:function(b,c,d){var e="px";for(var f in d)a[f]&&c.css(a[f],isNaN(d[f])?d[f]:d[f]+e)}}}]),angular.module("qti").directive("item",["$sce",function(){return{restrict:"E",scope:!0,link:function(a,b,c){a.item.questionId=c.ident,a.$broadcast("item::ready")},controller:["$scope",function(a){a.objective=null,a.item={}}]}}]),angular.module("qti").directive("backgroundColor",function(){return{restrict:"A",link:function(a,b,c){c.backgroundColor&&(b[0].style["background-color"]=c.backgroundColor)}}}),angular.module("qti").directive("border",function(){return{restrict:"A",link:function(a,b,c){var d=b[0],e="px";if(c.border)if(d.style["border-style"]="solid",-1===c.border.indexOf(","))d.style.border=parseInt(c.border,10)+e;else{var f=c.border.split(",");d.style["border-top-width"]=parseInt(f[0],10)+e,d.style["border-left-width"]=parseInt(f[1],10)+e,d.style["border-bottom-width"]=parseInt(f[2],10)+e,d.style["border-right-width"]=parseInt(f[3],10)+e}c.borderColor&&(d.style["border-color"]=c.borderColor)}}}),angular.module("qti").directive("firstlineindent",function(){return{restrict:"A",link:function(a,b,c){var d,e,f,g;for(e="",g=parseInt(c.firstlineindent,10),f=0;g>f;f+=1)e+="&nbsp;";for(d=b[0].querySelectorAll("mattext:not([fli]"),g=d.length,f=0;g>f;f+=1)d[f].getAttribute("firstlineindent")||(d[f].innerHTML=e+d[f].innerHTML,d[f].setAttribute("fli",""))}}}),angular.module("qti").directive("flow",function(){return{restrict:"E",scope:!0,link:function(a,b,c){var d,e=b[0],f="px";c.width&&(d=String(c.width).match(/\D+/),d?e.style.width=c.width+d[0]:(e.style.width=c.width+f,void 0===c.height&&(e.style.overflow=parseInt(c.width,10)>40?"auto":"hidden"))),c.height&&(d=String(c.height).match(/\D+/),e.style.height=d?c.height+d[0]:c.height+f)}}}),angular.module("qti").directive("inset",function(){return{restrict:"A",link:function(a,b,c){var d=b[0],e="px";if(c.inset)if(-1===c.inset.indexOf(","))d.style.padding=parseInt(c.inset,10)+e;else{var f=c.inset.split(",");d.style["padding-top"]=parseInt(f[0],10)+e,d.style["padding-left"]=parseInt(f[1],10)+e,d.style["padding-bottom"]=parseInt(f[2],10)+e,d.style["padding-right"]=parseInt(f[3],10)+e}}}}),angular.module("qti.plugins").directive("matimage",["helpers",function(a){return{restrict:"E",scope:!0,link:function(b,c,d){var e,f;f=a.strToXML("<img />").firstChild;var g;switch(d.valign){case"top":g="top";break;case"bottom":g="bottom";break;default:g="middle"}var h="vertical-align:"+g+";";d.hasOwnProperty("width")&&(h+="width:"+d.width+"px;"),d.hasOwnProperty("height")&&(h+="height:"+d.height+"px;"),d.hasOwnProperty("uri")?f.setAttribute("src",d.uri):d.hasOwnProperty("embedded")&&(e="data:image/jpg;base64,",f.setAttribute("src",e+c.text())),d.hasOwnProperty("alt")&&f.setAttribute("alt",d.alt),f.setAttribute("style",h),c.html(f.outerHTML)}}}]),angular.module("qti").directive("mattext",["$sce",function(){return{restrict:"E",scope:!0,link:function(a,b,c){c.hasOwnProperty("width")&&(b.css("width",c.width+"px"),b.css("display","inline-block")),c.hasOwnProperty("height")&&(b.css("height",c.height+"px"),b.css("display","inline-block")),c.hasOwnProperty("fontface")&&b.css("font-family",c.fontface),c.hasOwnProperty("fontsize")&&b.css("font-size",c.fontsize+"px")}}}]),angular.module("qti").service("mattext",["$rootScope","helpers",function(a,b){var c=function(a){for(var c,d=b.strToXML(a),e=d.querySelectorAll("mattext"),f=0;f<e.length;f++){c=e[f];var g=c.innerHTML;-1===g.indexOf("<")&&b.addClass(c,"qti-prewrap")}var h=new XMLSerializer;return a=h.serializeToString(d)};a.$on("qti::setup",function(a){a.targetScope.template=c(a.targetScope.template)})}]).run(["mattext",function(){}]),angular.module("qti.plugins").directive("matvideo",["$sce",function(a){return{restrict:"E",scope:!0,templateUrl:"templates/matvideo.html",link:function(b,c,d){b.currentTime=0,b.totalTime=0,b.state=null,b.volume=1,b.isCompleted=!1,b.API=null,b.onPlayerReady=function(a){b.API=a},b.onCompleteVideo=function(){b.isCompleted=!0},b.onUpdateState=function(a){b.state=a},b.onUpdateTime=function(a,c){b.currentTime=a,b.totalTime=c},b.onUpdateVolume=function(a){b.volume=a},b.onUpdateSize=function(a,c){b.config.width=a,b.config.height=c};var e={};e.autoHide=!1,e.autoHideTime=3e3,e.autoPlay="true"===d.autoPlay,e.playAvailable="false"!==d.playAvailable,e.pauseAvailable="false"!==d.pauseAvailable,e.stopAvailable="false"!==d.stopAvailable,e.progressAvailable="false"!==d.progressAvailable,e.seekAvailable="false"!==d.seekAvailable,e.volumeAvailable="false"!==d.volumeAvailable,e.sources=[{src:a.trustAsResourceUrl(d.uri)+"",type:"video/mp4"}],e.loop="true"===d.autoLoop,e.preload="auto",e.transclude=!1,e.controls=void 0,e.theme={url:d.themeuri},e.plugins={poster:{url:d.posteruri}},b.config=e}}}]),angular.module("qti.plugins").directive("mataudio",["$sce",function(a){return{restrict:"E",scope:!0,templateUrl:"templates/mataudio.html",link:function(b,c,d){b.currentTime=0,b.totalTime=0,b.state=null,b.volume=1,b.isCompleted=!1,b.API=null,b.onPlayerReady=function(a){b.API=a},b.onCompleteVideo=function(){b.isCompleted=!0},b.onUpdateState=function(a){b.state=a},b.onUpdateTime=function(a,c){b.currentTime=a,b.totalTime=c},b.onUpdateVolume=function(a){b.volume=a},b.onUpdateSize=function(a,c){b.config.width=a,b.config.height=c};var e={};e.autoHide=!1,e.autoHideTime=3e3,e.autoPlay="true"===d.autoPlay,e.playAvailable="false"!==d.playAvailable,e.pauseAvailable="false"!==d.pauseAvailable,e.stopAvailable="false"!==d.stopAvailable,e.progressAvailable="false"!==d.progressAvailable,e.seekAvailable="false"!==d.seekAvailable,e.volumeAvailable="false"!==d.volumeAvailable,e.sources=[{src:a.trustAsResourceUrl(d.uri)+"",type:"video/mp4"}],e.loop="true"===d.autoLoop,e.preload="auto",e.transclude=!1,e.controls=void 0,e.theme={url:d.themeuri},e.plugins={poster:{url:d.posteruri}},b.config=e}}}]),angular.module("qti.plugins").directive("vgBuffering",["VG_UTILS",function(a){return{restrict:"E",require:"^videogular",template:"<div class='bufferingContainer'><div ng-class='spinnerClass' class='loadingSpinner'></div></div>",link:function(b,c,d,e){function f(){b.spinnerClass={stop:e.isBuffering},c.css("display","block")}function g(){b.spinnerClass={stop:e.isBuffering},c.css("display","none")}function h(a){a?f():g()}function i(a){a&&g()}f(),a.isMobileDevice()?g():b.$watch(function(){return e.isReady},function(a,b){a!=b&&i(a)}),b.$watch(function(){return e.isBuffering},function(a,b){a!=b&&h(a)})}}}]),angular.module("qti.plugins").directive("vgControls",["$timeout","VG_STATES",function(a){return{restrict:"E",require:"^videogular",transclude:!0,template:'<div id="controls-container" ng-mousemove="onMouseMove()" ng-class="animationClass" ng-transclude></div>',scope:{autoHide:"=vgAutohide",autoHideTime:"=vgAutohideTime"},link:function(b){function c(){b.animationClass="hide-animation"}function d(){b.animationClass="show-animation",a.cancel(e),b.autoHide&&(e=a(c,f))}var e,f=2e3;b.onMouseMove=function(){b.autoHide&&d()},void 0!=b.autoHide&&b.$watch("autoHide",function(c){c?b.animationClass="hide-animation":(b.animationClass="",a.cancel(e),d())}),void 0!=b.autoHideTime&&b.$watch("autoHideTime",function(a){f=a})}}}]).directive("vgPlayPauseButton",["VG_STATES",function(a){return{restrict:"E",require:"^videogular",template:"<button class='iconButton' ng-click='onClickPlayPause()' ng-class='playPauseIcon' aria-label='Play/Pause'></button>",link:function(b,c,d,e){function f(c){switch(c){case a.PLAY:b.playPauseIcon={pause:!0};break;case a.PAUSE:b.playPauseIcon={play:!0};break;case a.STOP:b.playPauseIcon={play:!0}}}b.onClickPlayPause=function(){e.playPause()},b.playPauseIcon={play:!0},b.$watch(function(){return e.currentState},function(a,b){a!=b&&f(a)})}}}]).directive("vgTimedisplay",[function(){return{require:"^videogular",restrict:"E",link:function(a,b,c,d){a.$watch(function(){return d.currentTime},function(b,c){b!=c&&(a.currentTime=b)}),a.$watch(function(){return d.timeLeft},function(b,c){b!=c&&(a.timeLeft=b)}),a.$watch(function(){return d.totalTime},function(b,c){b!=c&&(a.totalTime=b)})}}}]).directive("vgScrubbar",["VG_STATES","VG_UTILS",function(a,b){return{restrict:"AE",require:"^videogular",transclude:!0,template:'<div role="slider" aria-valuemax="{{ariaTime(API.totalTime)}}" aria-valuenow="{{ariaTime(API.currentTime)}}" aria-valuemin="0" aria-label="Time scrub bar" tabindex="0" ng-transclude ng-keydown="onScrubBarKeyDown($event)"></div>',link:function(c,d,e,f){function g(a){var e,g=a.originalEvent||a,h=g.touches;s=b.isiOSDevice()?-1*(h[0].clientX-g.layerX):g.layerX,e=h[0].clientX+s-h[0].target.offsetLeft,p=!0,q&&(r=!0),f.pause(),n(e*f.mediaElement[0].duration/d[0].scrollWidth),c.$apply()}function h(a){a.originalEvent||a;r&&(r=!1,f.play()),p=!1,c.$apply()}function h(a){var b,e=a.originalEvent||a,g=e.touches;p&&(b=g[0].clientX+s-g[0].target.offsetLeft,n(b*f.mediaElement[0].duration/d[0].scrollWidth)),c.$apply()}function i(){p=!1,c.$apply()}function j(a){a=b.fixEventOffset(a),c.config.seekAvailable&&(p=!0,q&&(r=!0),f.pause(),n(a.offsetX*f.mediaElement[0].duration/d[0].scrollWidth),c.$apply())}function k(a){a=b.fixEventOffset(a),c.config.seekAvailable&&(r&&(r=!1,f.play()),p=!1,n(a.offsetX*f.mediaElement[0].duration/d[0].scrollWidth),c.$apply())}function l(a){p&&(a=b.fixEventOffset(a),n(a.offsetX*f.mediaElement[0].duration/d[0].scrollWidth)),c.$apply()}function m(){p=!1,c.$apply()}function n(a){c.config.seekAvailable&&f.seekTime(a,!1)}function o(b){if(!p)switch(b){case a.PLAY:q=!0;break;case a.PAUSE:q=!1;break;case a.STOP:q=!1}}var p=!1,q=!1,r=!1,s=0,t=37,u=39,v=1;c.API=f,c.ariaTime=function(a){return 0===a?"0":Math.round(a.getTime()/1e3)},c.onScrubBarKeyDown=function(a){var b=f.currentTime.getTime()/f.totalTime.getTime()*100;a.which===t||a.keyCode===t?(f.seekTime(b-v,!0),a.preventDefault()):(a.which===u||a.keyCode===u)&&(f.seekTime(b+v,!0),a.preventDefault())},c.$watch(function(){return f.currentState},function(a,b){a!=b&&o(a)}),b.isMobileDevice()?(d.bind("touchstart",g),d.bind("touchend",onScrubBarTouchEnd),d.bind("touchmove",h),d.bind("touchleave",i)):(d.bind("mousedown",j),d.bind("mouseup",k),d.bind("mousemove",l),d.bind("mouseleave",m))}}}]).directive("vgScrubbarcurrenttime",[function(){return{restrict:"E",require:"^videogular",link:function(a,b,c,d){function e(a){a&&d.totalTime&&(g=-1*a.getTime()/1e3*100/(-1*d.totalTime.getTime()/1e3),b.css("width",g+"%"))}function f(){g=0,b.css("width",g+"%")}var g=0;a.$watch(function(){return d.currentTime},function(a){e(a)}),a.$watch(function(){return d.isCompleted},function(a){f(a)})}}}]).directive("vgVolume",["VG_UTILS",function(a){return{restrict:"E",link:function(b,c){function d(){b.volumeVisibility="visible",b.$apply()}function e(){b.volumeVisibility="hidden",b.$apply()}a.isMobileDevice()?c.css("display","none"):(b.volumeVisibility="hidden",c.bind("mouseover",d),c.bind("mouseleave",e))}}}]).directive("vgVolumebar",["VG_UTILS",function(a){return{restrict:"E",require:"^videogular",template:"<div class='verticalVolumeBar'><div class='volumeBackground' ng-click='onClickVolume($event)' ng-mousedown='onMouseDownVolume()' ng-mouseup='onMouseUpVolume()' ng-mousemove='onMouseMoveVolume($event)' ng-mouseleave='onMouseLeaveVolume()'><div class='volumeValue'></div><div class='volumeClickArea'></div></div></div>",link:function(b,c,d,e){function f(a){a=100*a,j.css("height",a+"%"),j.css("top",100-a+"%")}function g(a){c.css("visibility",a)}var h=!1,i=angular.element(c[0].getElementsByClassName("volumeBackground")),j=angular.element(c[0].getElementsByClassName("volumeValue"));b.onClickVolume=function(b){b=a.fixEventOffset(b);var c=parseInt(i.prop("offsetHeight")),d=100*b.offsetY/c,f=1-d/100;e.setVolume(f)},b.onMouseDownVolume=function(){h=!0},b.onMouseUpVolume=function(){h=!1},b.onMouseLeaveVolume=function(){h=!1},b.onMouseMoveVolume=function(b){if(h){b=a.fixEventOffset(b);var c=parseInt(i.prop("offsetHeight")),d=100*b.offsetY/c,f=1-d/100;e.setVolume(f)}},c.css("visibility",b.volumeVisibility),b.$watch("volumeVisibility",g),b.$watch(function(){return e.volume},function(a,b){a!=b&&f(a)})}}}]).directive("vgMutebutton",[function(){return{restrict:"E",require:"^videogular",template:"<button class='iconButton' ng-class='muteIcon' ng-click='onClickMute()' ng-focus='onMuteButtonFocus()' ng-blur='onMuteButtonLoseFocus()' ng-keydown='onMuteButtonKeyDown($event)' aria-label='Mute'></button>",link:function(a,b,c,d){function e(b){a.currentVolume=b,f?b>0&&(a.defaultVolume=b):a.defaultVolume=b;var c=Math.round(100*b);0==c?a.muteIcon={mute:!0}:c>0&&25>c?a.muteIcon={level0:!0}:c>=25&&50>c?a.muteIcon={level1:!0}:c>=50&&75>c?a.muteIcon={level2:!0}:c>=75&&(a.muteIcon={level3:!0})}var f=!1,g=38,h=40,i=.05;a.onClickMute=function(){f?a.currentVolume=a.defaultVolume:(a.currentVolume=0,a.muteIcon={mute:!0}),f=!f,d.setVolume(a.currentVolume)},a.onMuteButtonFocus=function(){a.volumeVisibility="visible"},a.onMuteButtonLoseFocus=function(){a.volumeVisibility="hidden"},a.onMuteButtonKeyDown=function(a){var b=null!=d.volume?d.volume:1;a.which===g||a.keyCode===g?(d.setVolume(b+i),a.preventDefault()):(a.which===h||a.keyCode===h)&&(d.setVolume(b-i),a.preventDefault())},a.defaultVolume=1,a.currentVolume=a.defaultVolume,a.muteIcon={level3:!0},a.$watch(function(){return d.volume},function(a,b){a!=b&&e(a)})}}}]).directive("vgFullscreenbutton",[function(){return{restrict:"AE",require:"^videogular",scope:{vgEnterFullScreenIcon:"=",vgExitFullScreenIcon:"="},template:"<button class='iconButton' ng-click='onClickFullScreen()' ng-class='fullscreenIcon' aria-label='Toggle full screen'></button>",link:function(a,b,c,d){function e(b){a.fullscreenIcon={enter:!b,exit:b}}a.onClickFullScreen=function(){d.toggleFullScreen()},a.fullscreenIcon={exit:!1},a.fullscreenIcon={enter:!0},a.$watch(function(){return d.isFullScreen},function(a,b){a!=b&&e(a)})}}}]),angular.module("qti.plugins").directive("vgImaAds",["$window","VG_STATES",function(a,b){return{restrict:"E",require:"^videogular",scope:{vgNetwork:"=",vgUnitPath:"=",vgCompanion:"=",vgCompanionSize:"=",vgAdTagUrl:"=",vgSkipButton:"="},link:function(c,d,e,f){function g(a){a&&(f.mediaElement[0].addEventListener("ended",A),u=f.videogularElement[0].offsetWidth,v=f.videogularElement[0].offsetHeight,x.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,j,!1,this),x.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,p,!1,this),c.vgCompanion&&googletag.cmd.push(function(){googletag.defineSlot("/"+c.vgNetwork+"/"+c.vgUnitPath,c.vgCompanionSize,c.vgCompanion).addService(googletag.companionAds()).addService(googletag.pubads()),googletag.companionAds().setRefreshUnfilledSlots(!0),googletag.pubads().enableVideoAds(),googletag.enableServices()}))}function h(a){switch(a){case b.PLAY:z||(f.pause(),w.initialize(),i(c.vgAdTagUrl),z=!0);break;case b.STOP:x.contentComplete()}}function i(b){s();var c=new google.ima.AdsRequest,e=a.getComputedStyle(d[0]);c.adTagUrl=b,c.linearAdSlotWidth=parseInt(e.width,10),c.linearAdSlotHeight=parseInt(e.height,10),c.nonLinearAdSlotWidth=parseInt(e.width,10),c.nonLinearAdSlotHeight=parseInt(e.height,10),x.requestAds(c)}function j(a){s(),y=a.getAdsManager(f.mediaElement[0]),k(y)}function k(a){a.addEventListener(google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,n,!1,this),a.addEventListener(google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,o,!1,this),a.addEventListener(google.ima.AdEvent.Type.SKIPPABLE_STATE_CHANGED,l,!1,this),a.addEventListener(google.ima.AdEvent.Type.ALL_ADS_COMPLETED,q,!1,this),a.addEventListener(google.ima.AdEvent.Type.COMPLETE,r,!1,this),a.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,p,!1,this),a.init(u,v,google.ima.ViewMode.NORMAL),a.start()}function l(){var a=y.getAdSkippableState();a?C.css("display","block"):C.css("display","none")}function m(){y.skip()}function n(){s(),f.mediaElement[0].removeEventListener("ended",A),f.pause()}function o(){f.mediaElement[0].addEventListener("ended",A),f.play(),t()}function p(){y&&y.destroy(),t(),f.play()}function q(){t()}function r(){B++}function s(){d.css("display","block")}function t(){d.css("display","none")}var u,v,w=new google.ima.AdDisplayContainer(d[0]),x=new google.ima.AdsLoader(w),y=null,z=!1,A=function(){x.contentComplete()},B=0,C=angular.element(c.vgSkipButton);C.bind("click",m),d.prepend(C),angular.element(a).bind("resize",function(){u=f.videogularElement[0].offsetWidth,v=f.videogularElement[0].offsetHeight,y&&(f.isFullScreen?y.resize(u,v,google.ima.ViewMode.FULLSCREEN):y.resize(u,v,google.ima.ViewMode.NORMAL))}),c.$watch(function(){return f.isReady},function(a,b){a!=b&&g(a)}),c.$watch(function(){return f.currentState},function(a,b){a!=b&&h(a)})}}}]),angular.module("qti.plugins").directive("vgOverlayPlay",["VG_STATES",function(a){return{restrict:"E",require:"^videogular",template:"<div class='overlayPlayContainer' ng-click='onClickOverlayPlay()'><div class='iconButton' ng-class='overlayPlayIcon'></div></div>",link:function(b,c,d,e){function f(c){switch(console.log("newstate",c),c){case a.PLAY:b.overlayPlayIcon={};break;case a.PAUSE:b.overlayPlayIcon={play:!0};break;case a.STOP:b.overlayPlayIcon={play:!0}}}b.onClickOverlayPlay=function(){"play"===e.currentState&&b.config.pauseAvailable?e.pause():b.config.playAvailable&&e.play()},b.overlayPlayIcon={play:!0},b.$watch(function(){return e.currentState},function(a,b){a!=b&&f(a)})}}}]),angular.module("qti.plugins").directive("vgPosterImage",["VG_STATES",function(a){return{restrict:"E",require:"^videogular",scope:{vgUrl:"="},template:'<img ng-src="{{vgUrl}}">',link:function(b,c,d,e){function f(b){switch(b){case a.PLAY:c.css("display","none");break;case a.STOP:c.css("display","block")}}b.$watch(function(){return e.currentState},function(a,b){a!=b&&f(a)})}}}]),angular.module("qti").directive("objectives",function(){return{restrict:"E",link:function(a,b,c){a.objectives[c.ident]=b[0].querySelector("mattext").innerHTML,b[0].outerHTML=null,a.$on("item::ready",function(){})},controller:["$scope",function(a){a.objectives=a.objectives||{}}]}}),angular.module("qti").directive("presentation",["ATTR_MAP",function(a){return{restrict:"E",transclude:!0,templateUrl:"templates/presentation.html",link:function(b,c,d){var e=c[0].querySelector("mattext");e&&(b.item.question=e.innerHTML);for(var f in d)a[f]&&c.css(a[f],isNaN(d[f])?d[f]:d[f]+"px");b.$on("item::ready",function(){})},controller:["$scope",function(){}]}}]),angular.module("qti").directive("responseLid",function(){return{restrict:"E",scope:!0,transclude:!0,templateUrl:"templates/question-type.html",link:function(a,b,c){a.item.type=c.rcardinality},controller:["$scope",function(){}]}}),angular.module("qti").run(["$templateCache",function(a){"use strict";a.put("templates/assessment.html",'<div class=qti-assessment><div class=qti-title>{{assessment.title}}</div><div class=qti-content><div ng-transclude=""></div></div></div>'),a.put("templates/mataudio.html","<div class=qti-audio><videogular vg-player-ready=onPlayerReady vg-complete=onCompleteVideo vg-update-time=onUpdateTime vg-update-volume=onUpdateVolume vg-update-state=onUpdateState vg-theme=config.theme.url vg-autoplay=config.autoPlay><vg-audio vg-src=config.sources vg-tracks=config.tracks vg-loop=config.loop vg-preload=config.preload vg-native-controls=config.controls></vg-audio><vg-controls vg-autohide=config.autoHide vg-autohide-time=config.autoHideTime><vg-play-pause-button ng-if=\"config.playAvailable && config.pauseAvailable\"></vg-play-pause-button><vg-timedisplay ng-if=config.progressAvailable>{{ currentTime | date:'mm:ss' }}</vg-timedisplay><vg-scrubbar ng-if=config.progressAvailable><vg-scrubbarcurrenttime></vg-scrubbarcurrenttime></vg-scrubbar><div ng-if=!config.progressAvailable style=\"width: 100%;display: table-cell;cursor: default\"></div><vg-timedisplay ng-if=config.progressAvailable>{{ timeLeft | date:'mm:ss' }}</vg-timedisplay><vg-volume ng-if=config.volumeAvailable><vg-mutebutton></vg-mutebutton><vg-volumebar></vg-volumebar></vg-volume><vg-fullscreenbutton ng-if=config.fullscreenAvailable></vg-fullscreenbutton></vg-controls></videogular></div>"),a.put("templates/matvideo.html","<div class=qti-video><videogular vg-player-ready=onPlayerReady vg-complete=onCompleteVideo vg-update-time=onUpdateTime vg-update-volume=onUpdateVolume vg-update-state=onUpdateState vg-theme=config.theme.url vg-autoplay=config.autoPlay><vg-video vg-src=config.sources vg-tracks=config.tracks vg-loop=config.loop vg-preload=config.preload vg-native-controls=config.controls></vg-video><vg-controls vg-autohide=config.autoHide vg-autohide-time=config.autoHideTime><vg-play-pause-button ng-if=\"config.playAvailable && config.pauseAvailable\"></vg-play-pause-button><vg-timedisplay ng-if=config.progressAvailable>{{ currentTime | date:'mm:ss' }}</vg-timedisplay><vg-scrubbar ng-if=config.progressAvailable><vg-scrubbarcurrenttime></vg-scrubbarcurrenttime></vg-scrubbar><div ng-if=!config.progressAvailable style=\"width: 100%;display: table-cell;cursor: default\"></div><vg-timedisplay ng-if=config.progressAvailable>{{ timeLeft | date:'mm:ss' }}</vg-timedisplay><vg-volume ng-if=config.volumeAvailable><vg-mutebutton></vg-mutebutton><vg-volumebar></vg-volumebar></vg-volume><vg-fullscreenbutton ng-if=config.fullscreenAvailable></vg-fullscreenbutton></vg-controls><vg-poster-image vg-url=config.plugins.poster.url></vg-poster-image><vg-buffering></vg-buffering><vg-overlay-play vg-play-icon=config.theme.playIcon></vg-overlay-play></videogular></div>"),a.put("templates/presentation.html",'<div><div ng-transclude=""></div></div>')
}])}({},function(){return this}());