/*
* qti-1.2-engine 0.1.0
*/
angular.module("videogular",[]).run(["$window","VG_UTILS",function(a,b){var c,d={w3:{enabled:"fullscreenEnabled",element:"fullscreenElement",request:"requestFullscreen",exit:"exitFullscreen",onchange:"fullscreenchange",onerror:"fullscreenerror"},newWebkit:{enabled:"webkitFullscreenEnabled",element:"webkitFullscreenElement",request:"webkitRequestFullscreen",exit:"webkitExitFullscreen",onchange:"webkitfullscreenchange",onerror:"webkitfullscreenerror"},oldWebkit:{enabled:"webkitIsFullScreen",element:"webkitCurrentFullScreenElement",request:"webkitRequestFullScreen",exit:"webkitCancelFullScreen",onchange:"webkitfullscreenchange",onerror:"webkitfullscreenerror"},moz:{enabled:"mozFullScreen",element:"mozFullScreenElement",request:"mozRequestFullScreen",exit:"mozCancelFullScreen",onchange:"mozfullscreenchange",onerror:"mozfullscreenerror"},ios:{enabled:"webkitFullscreenEnabled",element:"webkitFullscreenElement",request:"webkitEnterFullscreen",exit:"webkitExitFullscreen",onchange:"webkitfullscreenchange",onerror:"webkitfullscreenerror"},ms:{enabled:"msFullscreenEnabled",element:"msFullscreenElement",request:"msRequestFullscreen",exit:"msExitFullscreen",onchange:"msfullscreenchange",onerror:"msfullscreenerror"}};for(var e in d)if(d[e].enabled in document){c=d[e],c.isFullScreen=function(){return null!==document[this.element]};break}b.isiOSDevice()&&(c=d.ios,c.isFullScreen=function(){return null!==document[this.element]}),angular.element(a)[0].fullScreenAPI=c}]),angular.module("videogular").directive("videogular",["$window","VG_STATES","VG_UTILS",function(a,b,c){return{restrict:"E",scope:{theme:"=vgTheme",autoPlay:"=vgAutoplay",vgComplete:"&",vgUpdateVolume:"&",vgUpdateTime:"&",vgUpdateState:"&",vgPlayerReady:"&",vgChangeSource:"&"},controller:["$scope","$timeout",function(d,e){var f=null,g=!1,h=!1,i=d.vgComplete(),j=d.vgUpdateVolume(),k=d.vgUpdateTime(),l=d.vgUpdateState(),m=d.vgPlayerReady(),n=d.vgChangeSource();this.videogularElement=null,this.clearMedia=function(){d.API.mediaElement[0].src=""},this.onMobileVideoReady=function(a,b){this.onVideoReady(a,b,!0)},this.onVideoReady=function(a,f,g){d.API.isReady=!0,d.API.currentState=b.STOP,g||d.$apply(),h=!0,d.vgPlayerReady()&&(m=d.vgPlayerReady())(d.API),(d.autoPlay&&!c.isMobileDevice()||d.API.currentState===b.PLAY)&&e(function(){d.API.play()})},this.onUpdateTime=function(a){d.API.currentTime=c.secondsToDate(a.target.currentTime),d.API.totalTime=c.secondsToDate(a.target.duration),d.API.timeLeft=c.secondsToDate(a.target.duration-a.target.currentTime),d.vgUpdateTime()&&(k=d.vgUpdateTime())(a.target.currentTime,a.target.duration),d.$apply()},this.$on=function(){d.$on.apply(d,arguments)},this.seekTime=function(a,b){var e;b?(e=a*d.API.mediaElement[0].duration/100,d.API.mediaElement[0].currentTime=e):(e=a,d.API.mediaElement[0].currentTime=e),d.API.currentTime=c.secondsToDate(e)},this.playPause=function(){d.API.mediaElement[0].paused?this.play():this.pause()},this.setState=function(a){return a&&a!==d.API.currentState&&(d.vgUpdateState()&&(l=d.vgUpdateState())(a),d.API.currentState=a),d.API.currentState},this.play=function(){d.API.mediaElement[0].play(),this.setState(b.PLAY)},this.pause=function(){d.API.mediaElement[0].pause(),this.setState(b.PAUSE)},this.stop=function(){d.API.mediaElement[0].pause(),d.API.mediaElement[0].currentTime=0,this.setState(b.STOP)},this.toggleFullScreen=function(){angular.element(a)[0].fullScreenAPI?angular.element(a)[0].fullScreenAPI.isFullScreen()?c.isMobileDevice()||document[angular.element(a)[0].fullScreenAPI.exit]():c.isMobileDevice()?c.isiOSDevice()?h?this.enterElementInFullScreen(d.API.mediaElement[0]):(g=!0,this.play()):this.enterElementInFullScreen(d.API.mediaElement[0]):this.enterElementInFullScreen(d.API.videogularElement[0]):(d.API.isFullScreen?(d.API.videogularElement.removeClass("fullscreen"),d.API.videogularElement.css("z-index",0)):(d.API.videogularElement.addClass("fullscreen"),d.API.videogularElement.css("z-index",c.getZIndex())),d.API.isFullScreen=!d.API.isFullScreen)},this.enterElementInFullScreen=function(b){b[angular.element(a)[0].fullScreenAPI.request]()},this.changeSource=function(a){d.vgChangeSource()&&(n=d.vgChangeSource())(a)},this.setVolume=function(a){d.vgUpdateVolume()&&(j=d.vgUpdateVolume())(a),d.API.mediaElement[0].volume=a,d.API.volume=a},this.updateTheme=function(a){if(f)for(var b=document.getElementsByTagName("link"),c=0,d=b.length;d>c;c++)b[c].outerHTML.indexOf(f)>=0&&b[c].parentNode.removeChild(b[c]);if(a){var e=angular.element(document).find("head");e.append('<link rel="stylesheet" href="'+a+'">'),f=a}},this.onStartBuffering=function(){d.API.isBuffering=!0},this.onStartPlaying=function(a){a.target.width++,a.target.width--,d.API.isBuffering=!1},this.onComplete=function(){d.vgComplete()&&(i=d.vgComplete())(),d.API.setState(b.STOP),d.API.isCompleted=!0,d.$apply()},d.API=this,d.init=function(){d.API.isReady=!1,d.API.isCompleted=!1,d.API.currentTime=0,d.API.totalTime=0,d.API.timeLeft=0,d.API.updateTheme(d.theme),d.addBindings(),angular.element(a)[0].fullScreenAPI&&document.addEventListener(angular.element(a)[0].fullScreenAPI.onchange,d.onFullScreenChange)},d.addBindings=function(){d.$watch("theme",function(a,b){a!=b&&d.API.updateTheme(a)}),d.$watch("autoPlay",function(a,b){a!==b&&a&&d.API.play()})},d.onFullScreenChange=function(){d.API.isFullScreen=angular.element(a)[0].fullScreenAPI.isFullScreen(),d.$apply()},d.$on("$destroy",this.clearMedia),d.$on("$routeChangeStart",this.clearMedia),d.init()}],link:{pre:function(a,b,c,d){d.videogularElement=angular.element(b)}}}}]),angular.module("videogular").constant("VG_STATES",{PLAY:"play",PAUSE:"pause",STOP:"stop"}),angular.module("videogular").directive("vgAudio",["$compile","VG_UTILS",function(a,b){return{restrict:"E",require:"^videogular",scope:{vgSrc:"=",vgLoop:"=",vgPreload:"=",vgNativeControls:"=",vgTracks:"="},link:function(c,d,e,f){var g='<audio vg-source="vgSrc" ';g+="></audio>",f.mediaElement=angular.element(g);var h=a(f.mediaElement)(c);f.mediaElement[0].addEventListener("loadedmetadata",f.onVideoReady,!1),f.mediaElement[0].addEventListener("waiting",f.onStartBuffering,!1),f.mediaElement[0].addEventListener("ended",f.onComplete,!1),f.mediaElement[0].addEventListener("playing",f.onStartPlaying,!1),f.mediaElement[0].addEventListener("timeupdate",f.onUpdateTime,!1),d.append(h),b.isMobileDevice()&&(f.mediaElement[0].removeEventListener("loadedmetadata",f.onVideoReady,!1),f.onMobileVideoReady())}}}]),angular.module("videogular").directive("vgLoop",function(){return{restrict:"A",require:"^videogular",link:{pre:function(a,b,c,d){var e;a.$watch(c.vgLoop,function(a,b){e&&a===b||!a?d.mediaElement.removeAttr("loop"):(e=a,d.mediaElement.attr("loop",e))})}}}}),angular.module("videogular").directive("vgNativeControls",function(){return{restrict:"A",require:"^videogular",link:{pre:function(a,b,c,d){var e;a.$watch(c.vgNativeControls,function(a,b){e&&a===b||!a?d.mediaElement.removeAttr("controls"):(e=a,d.mediaElement.attr("controls",""))})}}}}),angular.module("videogular").directive("vgPreload",function(){return{restrict:"A",require:"^videogular",link:{pre:function(a,b,c,d){var e;a.$watch(c.vgPreload,function(a,b){e&&a==b||!a?d.mediaElement.removeAttr("preload"):(e=a,d.mediaElement.attr("preload",e))})}}}}),angular.module("videogular").directive("vgSource",function(){return{restrict:"A",link:{pre:function(a,b,c){function d(){if(f="",b[0].canPlayType){for(var a=0,c=e.length;c>a;a++)if(f=b[0].canPlayType(e[a].type),"maybe"===f||"probably"===f){b.attr("src",e[a].src),b.attr("type",e[a].type);break}}else b.attr("src",e[0].src),b.attr("type",e[0].type)}var e,f;a.$watch(c.vgSource,function(a,b){e&&a===b||!a||(e=a,d())})}}}}),angular.module("videogular").directive("vgTracks",function(){return{restrict:"A",require:"^videogular",link:{pre:function(a,b,c,d){function e(){var a=d.mediaElement.children();for(h=0,i=a.length;i>h;h++)a[h].remove();if(f)for(h=0,i=f.length;i>h;h++){g="",g+="<track ";for(var b in f[h])g+=b+'="'+f[h][b]+'" ';g+="></track>",d.mediaElement.append(g,f[h].src)}}var f,g,h,i;a.$watch(c.vgTracks,function(a,b){f&&a==b||(f=a,d.tracks=f,e())})}}}}),angular.module("videogular").directive("vgVideo",["$compile","VG_UTILS",function(a,b){return{restrict:"E",require:"^videogular",scope:{vgSrc:"=",vgLoop:"=",vgPreload:"=",vgNativeControls:"=",vgTracks:"="},link:function(c,d,e,f){var g='<video vg-source="vgSrc" ';g+="></video>",f.mediaElement=angular.element(g);var h=a(f.mediaElement)(c);f.mediaElement[0].addEventListener("loadedmetadata",f.onVideoReady,!1),f.mediaElement[0].addEventListener("waiting",f.onStartBuffering,!1),f.mediaElement[0].addEventListener("ended",f.onComplete,!1),f.mediaElement[0].addEventListener("playing",f.onStartPlaying,!1),f.mediaElement[0].addEventListener("timeupdate",f.onUpdateTime,!1),d.append(h),b.isMobileDevice()&&(f.mediaElement[0].removeEventListener("loadedmetadata",f.onVideoReady,!1),f.onMobileVideoReady())}}}]),angular.module("videogular").directive("vgBuffering",["VG_UTILS",function(a){return{restrict:"E",require:"^videogular",template:'<div class="bufferingContainer">            <div ng-class="spinnerClass" class="loadingSpinner"></div>            </div>',link:function(b,c,d,e){function f(){b.spinnerClass={stop:e.isBuffering},c.css("display","block")}function g(){b.spinnerClass={stop:e.isBuffering},c.css("display","none")}function h(a){a?f():g()}function i(a){a&&g()}f(),a.isMobileDevice()?g():b.$watch(function(){return e.isReady},function(a,b){a!=b&&i(a)}),b.$watch(function(){return e.isBuffering},function(a,b){a!==b&&h(a)})}}}]),angular.module("videogular",[]).directive("vgOverlayPlay",["VG_STATES",function(a){return{restrict:"E",require:"^videogular",template:"<div class='overlayPlayContainer' ng-click='onClickOverlayPlay()'><div class='iconButton' ng-class='overlayPlayIcon'></div></div>",link:function(b,c,d,e){function f(c){switch(c){case a.PLAY:b.overlayPlayIcon={};break;case a.PAUSE:b.overlayPlayIcon={play:!0};break;case a.STOP:b.overlayPlayIcon={play:!0}}}b.onClickOverlayPlay=function(){e.playPause()},b.overlayPlayIcon={play:!0},b.$watch(function(){return e.currentState},function(a,b){a!=b&&f(a)})}}}]),angular.module("videogular",[]).directive("vgPosterImage",["VG_STATES",function(a){return{restrict:"E",require:"^videogular",scope:{vgUrl:"="},template:'<img ng-src="{{vgUrl}}">',link:function(b,c,d,e){function f(b){switch(b){case a.PLAY:c.css("display","none");break;case a.STOP:c.css("display","block")}}b.$watch(function(){return e.currentState},function(a,b){a!=b&&f(a)})}}}]),angular.module("videogular").directive("vgControls",["$timeout",function(a){return{restrict:"E",require:"^videogular",transclude:!0,template:'<div id="controls-container" ng-class="animationClass" ng-transclude></div>',scope:{autoHide:"=vgAutohide",autoHideTime:"=vgAutohideTime"},link:function(b,c,d,e){function f(){b.autoHide&&(h(),b.$apply())}function g(){b.animationClass="hide-animation"}function h(){b.animationClass="show-animation",a.cancel(i),b.autoHide&&(i=a(g,j))}var i,j=2e3;void 0!==b.autoHide&&b.$watch("autoHide",function(c){c?(b.animationClass="hide-animation",e.videogularElement.bind("mousemove",f)):(b.animationClass="",a.cancel(i),e.videogularElement.unbind("mousemove",f),h())}),void 0!=b.autoHideTime&&b.$watch("autoHideTime",function(a){j=a})}}}]),angular.module("videogular").directive("vgFullscreenbutton",function(){return{restrict:"AE",require:"^videogular",scope:{vgEnterFullScreenIcon:"=",vgExitFullScreenIcon:"="},template:'<button class="iconButton" ng-click="onClickFullScreen()" ng-class="fullscreenIcon" aria-label="Toggle full screen"></button>',link:function(a,b,c,d){function e(b){a.fullscreenIcon={enter:!b,exit:b}}a.onClickFullScreen=function(){d.toggleFullScreen()},a.fullscreenIcon={exit:!1},a.fullscreenIcon={enter:!0},a.$watch(function(){return d.isFullScreen},function(a,b){a!==b&&e(a)})}}}),angular.module("videogular").directive("vgMutebutton",function(){return{restrict:"E",require:"^videogular",template:'<button class="iconButton" ng-class="muteIcon"              ng-click="onClickMute()" ng-focus="onMuteButtonFocus()" ng-blur="onMuteButtonLoseFocus()" ng-keydown="onMuteButtonKeyDown($event)"              aria-label="Mute"></button>',link:function(a,b,c,d){function e(b){a.currentVolume=b,f?b>0&&(a.defaultVolume=b):a.defaultVolume=b;var c=Math.round(100*b);0===c?a.muteIcon={mute:!0}:c>0&&25>c?a.muteIcon={level0:!0}:c>=25&&50>c?a.muteIcon={level1:!0}:c>=50&&75>c?a.muteIcon={level2:!0}:c>=75&&(a.muteIcon={level3:!0})}var f=!1,g=38,h=40,i=.05;a.onClickMute=function(){f?a.currentVolume=a.defaultVolume:(a.currentVolume=0,a.muteIcon={mute:!0}),f=!f,d.setVolume(a.currentVolume)},a.onMuteButtonFocus=function(){a.volumeVisibility="visible"},a.onMuteButtonLoseFocus=function(){a.volumeVisibility="hidden"},a.onMuteButtonKeyDown=function(a){var b=null!==d.volume?d.volume:1;a.which===g||a.keyCode===g?(d.setVolume(b+i),a.preventDefault()):(a.which===h||a.keyCode===h)&&(d.setVolume(b-i),a.preventDefault())},a.defaultVolume=1,a.currentVolume=a.defaultVolume,a.muteIcon={level3:!0},a.$watch(function(){return d.volume},function(a,b){a!==b&&e(a)})}}}),angular.module("videogular").directive("vgPlayPauseButton",["VG_STATES",function(a){return{restrict:"E",require:"^videogular",template:'<button class="iconButton" ng-click="onClickPlayPause()" ng-class="playPauseIcon" aria-label="Play/Pause"></button>',link:function(b,c,d,e){function f(c){switch(c){case a.PLAY:b.playPauseIcon={pause:!0};break;case a.PAUSE:b.playPauseIcon={play:!0};break;case a.STOP:b.playPauseIcon={play:!0}}}b.onClickPlayPause=function(){e.playPause()},b.playPauseIcon={play:!0},b.$watch(function(){return e.currentState},function(a,b){a!==b&&f(a)})}}}]),angular.module("videogular").directive("vgScrubbarcurrenttime",function(){return{restrict:"E",require:"^videogular",link:function(a,b,c,d){function e(a){a&&d.totalTime&&(g=-1*a.getTime()/1e3*100/(-1*d.totalTime.getTime()/1e3),b.css("width",g+"%"))}function f(){g=0,b.css("width",g+"%")}var g=0;a.$watch(function(){return d.currentTime},function(a){e(a)}),a.$watch(function(){return d.isCompleted},function(a){f(a)})}}}),angular.module("videogular").directive("vgScrubbar",["VG_STATES","VG_UTILS",function(a,b){return{restrict:"AE",require:"^videogular",transclude:!0,template:'<div role="slider" aria-valuemax="{{ariaTime(API.totalTime)}}"                 aria-valuenow="{{ariaTime(API.currentTime)}}"                 aria-valuemin="0" aria-label="Time scrub bar" tabindex="0"                 ng-transclude ng-keydown="onScrubBarKeyDown($event)"></div>',link:function(c,d,e,f){function g(a){var e,g=a.touches;t=b.isiOSDevice()?-1*(g[0].clientX-a.layerX):a.layerX,e=g[0].clientX+t-g[0].target.offsetLeft,q=!0,r&&(s=!0),f.pause(),o(e*f.mediaElement[0].duration/d[0].scrollWidth),c.$apply()}function h(){s&&(s=!1,f.play()),q=!1,c.$apply()}function i(a){var b,e=a.touches;q&&(b=e[0].clientX+t-e[0].target.offsetLeft,o(b*f.mediaElement[0].duration/d[0].scrollWidth)),c.$apply()}function j(){q=!1,c.$apply()}function k(a){a=b.fixEventOffset(a),q=!0,r&&(s=!0),f.pause(),o(a.offsetX*f.mediaElement[0].duration/d[0].scrollWidth),c.$apply()}function l(a){a=b.fixEventOffset(a),s&&(s=!1,f.play()),q=!1,o(a.offsetX*f.mediaElement[0].duration/d[0].scrollWidth),c.$apply()}function m(a){q&&(a=b.fixEventOffset(a),o(a.offsetX*f.mediaElement[0].duration/d[0].scrollWidth)),c.$apply()}function n(){q=!1,c.$apply()}function o(a){f.seekTime(a,!1)}function p(b){if(!q)switch(b){case a.PLAY:r=!0;break;case a.PAUSE:r=!1;break;case a.STOP:r=!1}}var q=!1,r=!1,s=!1,t=0,u=37,v=39,w=1;c.API=f,c.ariaTime=function(a){return 0===a?"0":Math.round(a.getTime()/1e3)},c.onScrubBarKeyDown=function(a){var b=f.currentTime.getTime()/f.totalTime.getTime()*100;a.which===u||a.keyCode===u?(f.seekTime(b-w,!0),a.preventDefault()):(a.which===v||a.keyCode===v)&&(f.seekTime(b+w,!0),a.preventDefault())},c.$watch(function(){return f.currentState},function(a,b){a!==b&&p(a)}),b.isMobileDevice()?(d.bind("touchstart",g),d.bind("touchend",h),d.bind("touchmove",i),d.bind("touchleave",j)):(d.bind("mousedown",k),d.bind("mouseup",l),d.bind("mousemove",m),d.bind("mouseleave",n))}}}]),angular.module("videogular").directive("vgTimedisplay",function(){return{require:"^videogular",restrict:"E",link:function(a,b,c,d){a.$watch(function(){return d.currentTime},function(b,c){b!==c&&(a.currentTime=b)}),a.$watch(function(){return d.timeLeft},function(b,c){b!==c&&(a.timeLeft=b)}),a.$watch(function(){return d.totalTime},function(b,c){b!==c&&(a.totalTime=b)})}}}),angular.module("videogular").directive("vgVolumebar",["VG_UTILS",function(a){return{restrict:"E",require:"^videogular",template:'<div class="verticalVolumeBar">            <div class="volumeBackground" ng-click="onClickVolume($event)" ng-mousedown="onMouseDownVolume()" ng-mouseup="onMouseUpVolume()" ng-mousemove="onMouseMoveVolume($event)" ng-mouseleave="onMouseLeaveVolume()">            <div class="volumeValue"></div>            <div class="volumeClickArea"></div>            </div>            </div>',link:function(b,c,d,e){function f(a){a=100*a,j.css("height",a+"%"),j.css("top",100-a+"%")}function g(a){c.css("visibility",a)}var h=!1,i=angular.element(c[0].getElementsByClassName("volumeBackground")),j=angular.element(c[0].getElementsByClassName("volumeValue"));b.onClickVolume=function(b){b=a.fixEventOffset(b);var c=parseInt(i.prop("offsetHeight")),d=100*b.offsetY/c,f=1-d/100;e.setVolume(f)},b.onMouseDownVolume=function(){h=!0},b.onMouseUpVolume=function(){h=!1},b.onMouseLeaveVolume=function(){h=!1},b.onMouseMoveVolume=function(b){if(h){b=a.fixEventOffset(b);var c=parseInt(i.prop("offsetHeight")),d=100*b.offsetY/c,f=1-d/100;e.setVolume(f)}},c.css("visibility",b.volumeVisibility),b.$watch("volumeVisibility",g),b.$watch(function(){return e.volume},function(a,b){a!==b&&f(a)})}}}]),angular.module("videogular").directive("vgVolume",["VG_UTILS",function(a){return{restrict:"E",link:function(b,c){function d(){b.volumeVisibility="visible",b.$apply()}function e(){b.volumeVisibility="hidden",b.$apply()}a.isMobileDevice()?c.css("display","none"):(b.volumeVisibility="hidden",c.bind("mouseover",d),c.bind("mouseleave",e))}}}]),angular.module("videogular").service("VG_UTILS",function(){this.fixEventOffset=function(a){if(navigator.userAgent.match(/Firefox/i)){var b=a.currentTarget.currentStyle||window.getComputedStyle(a.target,null),c=parseInt(b.borderLeftWidth,10),d=parseInt(b.borderTopWidth,10),e=a.currentTarget.getBoundingClientRect(),f=a.clientX-c-e.left,g=a.clientY-d-e.top;a.offsetX=f,a.offsetY=g}return a},this.getZIndex=function(){var a=1;return angular.element("*").filter(function(){return"auto"!==angular.element(this).css("zIndex")}).each(function(){var b=parseInt(angular.element(this).css("zIndex"));b>a&&(a=b+1)}),a},this.secondsToDate=function(a){var b=new Date;return b.setTime(1e3*a),b},this.isMobileDevice=function(){return"undefined"!=typeof window.orientation||-1!==navigator.userAgent.indexOf("IEMobile")},this.isiOSDevice=function(){return navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/iPad/i)}});